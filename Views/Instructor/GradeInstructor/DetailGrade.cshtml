@model BTL_QuanLyLopHocTrucTuyen.Models.Submission

@{
    ViewData["Title"] = "Chi ti·∫øt ƒëi·ªÉm s·ªë";
    Layout = "~/Views/Instructor/Shared/_InstructorLayout.cshtml";
}

<link rel="stylesheet" href="~/css/Instructor/Grade/DetailGrade.css" asp-append-version="true" />

<div class="content-main detail-grade">
    <!-- üîπ Ti√™u ƒë·ªÅ -->
    <div class="header-detail d-flex justify-content-between align-items-center mb-4">
        <h4 class="fw-bold text-primary mb-0">
            <i class="bi bi-clipboard-data me-2"></i>Chi ti·∫øt ƒëi·ªÉm s·ªë
        </h4>
        <a asp-controller="GradeInstructor" asp-action="Grade" class="btn btn-outline-secondary">
            <i class="bi bi-arrow-left-circle me-1"></i> Quay l·∫°i danh s√°ch
        </a>
    </div>

    <!-- üîπ Th√¥ng tin h·ªçc vi√™n & b√†i t·∫≠p -->
    <div class="info-grid">
        <div class="card info-card">
            <div class="card-body">
                <h5 class="card-title"><i class="bi bi-person-circle me-2"></i>Th√¥ng tin h·ªçc vi√™n</h5>
                <p><strong>üë§ H·ªç t√™n:</strong> @Model.Student?.FullName</p>
                <p><strong>üìß Email:</strong> @Model.Student?.Email</p>
            </div>
        </div>

        <div class="card info-card">
            <div class="card-body">
                <h5 class="card-title"><i class="bi bi-journal-check me-2"></i>Th√¥ng tin b√†i t·∫≠p</h5>
                <p><strong>üìò Kh√≥a h·ªçc:</strong> @Model.Assignment?.Lesson?.Course?.Name</p>
                <p><strong>üìù B√†i t·∫≠p:</strong> @Model.Assignment?.Title</p>
                <p><strong>üìÖ Ng√†y n·ªôp:</strong> @Model.SubmittedAt.ToString("dd/MM/yyyy")</p>
                <p><strong>‚è∞ H·∫°n n·ªôp:</strong> 
                    @Model.Assignment?.AvailableUntil?.ToString("dd/MM/yyyy")</p>
            </div>
        </div>
    </div>

    <!-- üîπ ƒêi·ªÉm v√† nh·∫≠n x√©t -->
    <div class="grade-section mt-4">
        <div class="card grade-card shadow-sm">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h5 class="card-title mb-0">
                        <i class="bi bi-bar-chart-line me-2"></i>K·∫øt qu·∫£ ƒë√°nh gi√°
                    </h5>

                    <span id="gradeDisplay">
                        @if (Model.Grade.HasValue)
                        {
                            <span class="badge bg-success fs-5 px-3 py-2">@Model.Grade</span>
                        }
                        else
                        {
                            <span class="badge bg-warning text-dark fs-6 px-3 py-2">Ch∆∞a ch·∫•m</span>
                        }
                    </span>
                </div>

                <!-- üü¢ Form nh·∫≠p ƒëi·ªÉm (·∫©n ban ƒë·∫ßu) -->
                <div id="gradeForm" style="display:none;">
                    <form asp-action="UpdateGrade" method="post">
                        <input type="hidden" name="id" value="@Model.Id" />

                        <div class="mb-3">
                            <label class="form-label fw-bold">ƒêi·ªÉm</label>
                            <input type="number" name="grade" class="form-control" step="0.1"
                                min="0" max="10" value="@(Model.Grade ?? 0)">
                        </div>

                        <div class="text-end">
                            <button type="submit" class="btn btn-success">
                                <i class="bi bi-check-circle me-1"></i> L∆∞u
                            </button>
                            <button type="button" class="btn btn-outline-secondary" id="cancelGrade">
                                <i class="bi bi-x-circle me-1"></i> H·ªßy
                            </button>
                        </div>
                    </form>
                </div>

                <!-- üü¢ Hi·ªÉn th·ªã th√¥ng tin -->
                <div id="gradeInfo">
                    <p><strong>üìÑ T·ªáp b√†i n·ªôp:</strong></p>
                    @if (!string.IsNullOrEmpty(Model.FileUrl))
                    {
                        <a href="@Model.FileUrl" target="_blank" class="link-primary text-decoration-none">
                            <i class="bi bi-paperclip"></i> @System.IO.Path.GetFileName(Model.FileUrl)
                        </a>
                    }
                    else
                    {
                        <p class="text-muted fst-italic">Kh√¥ng c√≥ t·ªáp ƒë√≠nh k√®m.</p>
                    }
                </div>
            </div>
        </div>
    </div>

    <!-- üîπ N√∫t h√†nh ƒë·ªông -->
    <div class="action-buttons mt-4 d-flex justify-content-end gap-3">
        @if (!string.IsNullOrEmpty(Model.FileUrl))
        {
            <a href="@Model.FileUrl" class="btn btn-outline-secondary" target="_blank">
                <i class="bi bi-download me-1"></i> T·∫£i b√†i n·ªôp
            </a>
        }
        <button id="btnEditGrade" class="btn btn-primary">
            <i class="bi bi-pencil-square me-1"></i> Ch·∫•m ƒëi·ªÉm
        </button>
    </div>
</div>
@section Scripts {
    <script src="~/js/Instructor/Grade/DetailGrade.js" asp-append-version="true"></script>
}
